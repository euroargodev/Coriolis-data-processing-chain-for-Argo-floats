% From "Processing Argo pH Data at the DAC Level, Version 0, 7 September 2017,
% Kenneth S. Johnson, Joshua N. Plant, Tanya L. Maurer"

Vrs = [-0.922691 -0.922110 -0.921226 -0.920056 -0.918651 -0.917050 -0.915267 -0.914260 -0.913091 -0.912048 -0.911117 -0.910301 -0.909649 -0.908942 -0.908317 -0.907575 -0.906749 -0.892025 -0.891988 -0.891948 -0.891946 -0.891897 -0.891860 -0.891712 -0.891747 -0.891667 -0.891637];
Press = [1598.78 1498.61 1398.77 1299.25 1198.84 1099.64 999.36 951.66 900.56 850.87 801.08 749.16 701.59 650.81 601.52 550.92 501.11 51.06 46.07 41.10 36.36 31.69 26.39 21.84 16.34 11.80 7.62];
Temp = [2.9225 3.1302 3.3575 3.6987 4.2011 4.7072 5.2709 5.5806 5.8022 6.0924 6.3237 6.5121 6.7193 6.8914 7.0795 7.2701 7.4840 15.5472 15.5544 15.5561 15.5614 15.5588 15.5584 15.5577 15.5569 15.5592 15.5588];
Salt = [34.5006 34.4472 34.4010 34.3625 34.3332 34.3171 34.3106 34.3132 34.3130 34.3179 34.3277 34.3376 34.3521 34.3651 34.3806 34.3966 34.4152 34.5643 34.5642 34.5638 34.5650 34.5649 34.5650 34.5644 34.5648 34.5658 34.5662];

k0 = -1.372714;
k2 = -0.001063;
Pcoefs = [4.15927E-06	-2.53737E-08	2.87941E-11	-1.33263E-14	2.23781E-18];

phfree_expected = [7.9088 7.9112 7.9190 7.9307 7.9446 7.9614 7.9800 7.9908 8.0049 8.0157 8.0249 8.0319 8.0359 8.0406 8.0436 8.0483 8.0542 8.1754 8.1759 8.1766 8.1766 8.1776 8.1783 8.1810 8.1805 8.1820 8.1826];
phtot_expected = [7.8673 7.8690 7.8761 7.8869 7.8994 7.9149 7.9320 7.9420 7.9554 7.9654 7.9740 7.9804 7.9838 7.9879 7.9903 7.9943 7.9995 8.0980 8.0985 8.0991 8.0991 8.1000 8.1007 8.1034 8.1028 8.1043 8.1050];

[phfree,phtot]= phcalc(Vrs', Press', Temp', Salt', k0, k2, Pcoefs');

phfree
phtot
(phfree-phfree_expected')
(phtot-phtot_expected')

max(abs(phfree-phfree_expected'))
max(abs(phtot-phtot_expected'))


>>
phfree =

    7.9088
    7.9112
    7.9190
    7.9307
    7.9446
    7.9614
    7.9800
    7.9908
    8.0049
    8.0157
    8.0249
    8.0319
    8.0359
    8.0406
    8.0436
    8.0483
    8.0542
    8.1754
    8.1759
    8.1766
    8.1766
    8.1776
    8.1783
    8.1810
    8.1805
    8.1820
    8.1826


phtot =

    7.8673
    7.8690
    7.8761
    7.8869
    7.8994
    7.9149
    7.9320
    7.9420
    7.9554
    7.9654
    7.9740
    7.9804
    7.9838
    7.9879
    7.9903
    7.9943
    7.9995
    8.0980
    8.0985
    8.0991
    8.0991
    8.1000
    8.1007
    8.1034
    8.1028
    8.1043
    8.1050


ans =

   1.0e-04 *

   -0.2102
   -0.3457
    0.0938
    0.4892
   -0.2514
    0.4428
   -0.4714
   -0.3359
   -0.3055
   -0.0137
   -0.1400
    0.0068
    0.3005
    0.4864
    0.2999
   -0.0892
   -0.3845
   -0.0443
    0.4362
    0.2580
    0.4082
   -0.2892
   -0.0526
   -0.4243
   -0.1906
   -0.1926
    0.3842


ans =

   1.0e-04 *

    0.2691
    0.2432
    0.3283
    0.0449
    0.2082
    0.4658
   -0.4328
   -0.4355
    0.1190
    0.4343
   -0.4962
   -0.3613
   -0.4009
    0.0575
   -0.2159
    0.1453
    0.0341
   -0.3259
   -0.3038
    0.2190
   -0.0304
    0.1091
    0.0864
   -0.4938
    0.4800
    0.1748
   -0.4527


ans =

   4.8924e-05


ans =

   4.9620e-05


